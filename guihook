-- üìå Remote Explorer (Final Version)

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local RS = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

-- üîé Safe decode biar readable
local function safeDecode(data, depth)
    depth = depth or 0
    if depth > 4 then return "<Max Depth>" end

    local t = typeof(data)
    if t == "string" then
        return '"'..data..'"'
    elseif t == "number" or t == "boolean" then
        return tostring(data)
    elseif t == "table" then
        local out = "{"
        local count = 0
        for k,v in pairs(data) do
            count += 1
            if count > 20 then 
                out = out.."\n  ...<truncated>..."
                break
            end
            out = out.."\n  ["..safeDecode(k, depth+1).."] = "..safeDecode(v, depth+1)
        end
        return out.."\n}"
    elseif t == "Instance" then
        return "<Instance: "..data:GetFullName()..">"
    else
        return tostring(data)
    end
end

-- ü™ü GUI Builder
local function CreateWindow(title)
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)

    local Main = Instance.new("Frame")
    Main.Size = UDim2.new(0, 450, 0, 320)
    Main.Position = UDim2.new(0.3, 0, 0.25, 0)
    Main.BackgroundColor3 = Color3.fromRGB(25,25,25)
    Main.BorderSizePixel = 0
    Main.Active = true
    Main.Draggable = true
    Main.Parent = ScreenGui

    local Header = Instance.new("TextLabel")
    Header.Size = UDim2.new(1, -80, 0, 30)
    Header.BackgroundColor3 = Color3.fromRGB(35,35,35)
    Header.Text = title
    Header.TextColor3 = Color3.new(1,1,1)
    Header.Font = Enum.Font.GothamBold
    Header.TextSize = 14
    Header.TextXAlignment = Enum.TextXAlignment.Left
    Header.BorderSizePixel = 0
    Header.Parent = Main

    local TabBar = Instance.new("Frame")
    TabBar.Size = UDim2.new(1, 0, 0, 25)
    TabBar.Position = UDim2.new(0,0,0,30)
    TabBar.BackgroundColor3 = Color3.fromRGB(30,30,30)
    TabBar.BorderSizePixel = 0
    TabBar.Parent = Main

    local Content = Instance.new("Frame")
    Content.Size = UDim2.new(1,0,1,-55)
    Content.Position = UDim2.new(0,0,0,55)
    Content.BackgroundTransparency = 1
    Content.Parent = Main

    local Minimize = Instance.new("TextButton")
    Minimize.Size = UDim2.new(0,40,0,30)
    Minimize.Position = UDim2.new(1,-80,0,0)
    Minimize.Text = "-"
    Minimize.TextColor3 = Color3.new(1,1,1)
    Minimize.BackgroundColor3 = Color3.fromRGB(60,60,60)
    Minimize.Parent = Main

    local Close = Instance.new("TextButton")
    Close.Size = UDim2.new(0,40,0,30)
    Close.Position = UDim2.new(1,-40,0,0)
    Close.Text = "X"
    Close.TextColor3 = Color3.new(1,1,1)
    Close.BackgroundColor3 = Color3.fromRGB(100,50,50)
    Close.Parent = Main

    local Tabs = {}
    local CurrentTab

    local function AddTab(name)
        local Button = Instance.new("TextButton")
        Button.Size = UDim2.new(0,100,1,0)
        Button.BackgroundColor3 = Color3.fromRGB(50,50,50)
        Button.Text = name
        Button.TextColor3 = Color3.new(1,1,1)
        Button.Font = Enum.Font.Gotham
        Button.TextSize = 12
        Button.Parent = TabBar

        local Page = Instance.new("Frame")
        Page.Size = UDim2.new(1,0,1,0)
        Page.BackgroundTransparency = 1
        Page.Visible = false
        Page.Parent = Content

        Button.MouseButton1Click:Connect(function()
            if CurrentTab then CurrentTab.Visible = false end
            Page.Visible = true
            CurrentTab = Page
        end)

        Tabs[name] = Page
        if not CurrentTab then
            CurrentTab = Page
            Page.Visible = true
        end
        return Page
    end

    local Minimized = false
    Minimize.MouseButton1Click:Connect(function()
        Minimized = not Minimized
        if Minimized then
            Content.Visible = false
            TabBar.Visible = false
            Main.Size = UDim2.new(0,450,0,30)
        else
            Content.Visible = true
            TabBar.Visible = true
            Main.Size = UDim2.new(0,450,0,320)
        end
    end)

    Close.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)

    return AddTab, ScreenGui
end

-- üè† Main Window
local AddTab, Gui = CreateWindow("Remote Explorer")

-- üìå Tab Rescan
local ScanTab = AddTab("Rescan")
local Search = Instance.new("TextBox", ScanTab)
Search.Size = UDim2.new(1,-10,0,25)
Search.Position = UDim2.new(0,5,0,5)
Search.PlaceholderText = "Search Remote..."
Search.BackgroundColor3 = Color3.fromRGB(40,40,40)
Search.TextColor3 = Color3.new(1,1,1)

local RemoteList = Instance.new("ScrollingFrame", ScanTab)
RemoteList.Size = UDim2.new(1,-10,1,-40)
RemoteList.Position = UDim2.new(0,5,0,35)
RemoteList.BackgroundTransparency = 1
RemoteList.ScrollBarThickness = 6

-- üìå Halaman Detail
local DetailPage = Instance.new("Frame", Gui)
DetailPage.Size = UDim2.new(0,450,0,320)
DetailPage.Position = UDim2.new(0.3,0,0.25,0)
DetailPage.BackgroundColor3 = Color3.fromRGB(25,25,25)
DetailPage.Visible = false
DetailPage.Active = true
DetailPage.Draggable = true

local BackBtn = Instance.new("TextButton", DetailPage)
BackBtn.Size = UDim2.new(0,60,0,25)
BackBtn.Position = UDim2.new(0,5,0,5)
BackBtn.Text = "< Back"
BackBtn.TextColor3 = Color3.new(1,1,1)
BackBtn.BackgroundColor3 = Color3.fromRGB(70,70,70)

local CopyBtn = Instance.new("TextButton", DetailPage)
CopyBtn.Size = UDim2.new(0,60,0,25)
CopyBtn.Position = UDim2.new(0,75,0,5)
CopyBtn.Text = "Copy"
CopyBtn.TextColor3 = Color3.new(1,1,1)
CopyBtn.BackgroundColor3 = Color3.fromRGB(70,70,70)

local ClearBtn = Instance.new("TextButton", DetailPage)
ClearBtn.Size = UDim2.new(0,60,0,25)
ClearBtn.Position = UDim2.new(0,145,0,5)
ClearBtn.Text = "Clear"
ClearBtn.TextColor3 = Color3.new(1,1,1)
ClearBtn.BackgroundColor3 = Color3.fromRGB(70,50,50)

local DetailLog = Instance.new("ScrollingFrame", DetailPage)
DetailLog.Size = UDim2.new(1,-10,1,-40)
DetailLog.Position = UDim2.new(0,5,0,35)
DetailLog.BackgroundTransparency = 1
DetailLog.ScrollBarThickness = 6

local CurrentLogs = {}
local CurrentRemote

-- Render detail
local function ShowDetail(remote)
    CurrentRemote = remote
    DetailLog:ClearAllChildren()
    CurrentLogs = {}

    local function AddLine(txt)
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1,-10,0,0)
        Label.AutomaticSize = Enum.AutomaticSize.Y
        Label.BackgroundTransparency = 1
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.TextYAlignment = Enum.TextYAlignment.Top
        Label.TextWrapped = true
        Label.TextColor3 = Color3.new(1,1,1)
        Label.Font = Enum.Font.Code
        Label.TextSize = 12
        Label.Text = txt
        Label.Parent = DetailLog
        DetailLog.CanvasSize = UDim2.new(0,0,0,DetailLog.CanvasSize.Y.Offset + Label.TextBounds.Y + 6)
    end

    local header = "Name: "..remote.Name..
        "\nClass: "..remote.ClassName..
        "\nPath: "..remote:GetFullName()..
        "\n\nProperties:"
    AddLine(header)

    for _,prop in ipairs({"Archivable","Name","ClassName","Parent"}) do
        local ok, val = pcall(function() return tostring(remote[prop]) end)
        if ok then
            AddLine("  "..prop..": "..val)
        end
    end

    AddLine("\n[ Logs ]")
end

-- Refresh daftar remote
local function RefreshRemotes()
    RemoteList:ClearAllChildren()
    local y = 0
    for _,v in ipairs(RS:GetDescendants()) do
        if v:IsA("RemoteEvent") or v:IsA("RemoteFunction") then
            if Search.Text == "" or v.Name:lower():find(Search.Text:lower()) then
                local Btn = Instance.new("TextButton")
                Btn.Size = UDim2.new(1,-10,0,25)
                Btn.Position = UDim2.new(0,5,0,y)
                Btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
                Btn.TextColor3 = Color3.new(1,1,1)
                Btn.Text = v:GetFullName()
                Btn.Parent = RemoteList
                y = y + 30

                Btn.MouseButton1Click:Connect(function()
                    Gui.Enabled = false
                    DetailPage.Visible = true
                    ShowDetail(v)
                end)

                -- Hook event
                if v:IsA("RemoteEvent") then
                    v.OnClientEvent:Connect(function(...)
                        if v == CurrentRemote then
                            local args = {...}
                            local msg = ""
                            for i,arg in ipairs(args) do
                                msg = msg.."\n["..i.."] = "..safeDecode(arg)
                            end
                            table.insert(CurrentLogs, msg)
                            ShowDetail(v)
                            for _,line in ipairs(CurrentLogs) do
                                local l = Instance.new("TextLabel")
                                l.Size = UDim2.new(1,-10,0,0)
                                l.AutomaticSize = Enum.AutomaticSize.Y
                                l.BackgroundTransparency = 1
                                l.TextXAlignment = Enum.TextXAlignment.Left
                                l.TextYAlignment = Enum.TextYAlignment.Top
                                l.TextWrapped = true
                                l.TextColor3 = Color3.new(1,1,1)
                                l.Font = Enum.Font.Code
                                l.TextSize = 12
                                l.Text = line
                                l.Parent = DetailLog
                                DetailLog.CanvasSize = UDim2.new(0,0,0,DetailLog.CanvasSize.Y.Offset + l.TextBounds.Y + 6)
                            end
                        end
                    end)
                end
            end
        end
    end
    RemoteList.CanvasSize = UDim2.new(0,0,0,y)
end
Search:GetPropertyChangedSignal("Text"):Connect(RefreshRemotes)
RefreshRemotes()

-- Back
BackBtn.MouseButton1Click:Connect(function()
    DetailPage.Visible = false
    Gui.Enabled = true
end)

-- Copy
CopyBtn.MouseButton1Click:Connect(function()
    if setclipboard then
        setclipboard(table.concat(CurrentLogs, "\n"))
    end
end)

-- Clear
ClearBtn.MouseButton1Click:Connect(function()
    CurrentLogs = {}
    DetailLog:ClearAllChildren()
end)
